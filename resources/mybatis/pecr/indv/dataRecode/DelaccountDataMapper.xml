<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="DelaccountDataMapper">

<resultMap type="com.dcits.supervise.pecr.indv.entity.inDel" id="inDellistResultMap">
		<result column="PBY_IN_ACCT_DEL_ID" property="pk"/> 
		<result column="INF_REC_TYPE" property="infRecType"/> 
		<result column="ACCT_TYPE" property="acctType"/> 
		<result column="DEL_REC_CODE" property="delRecCode"/> 
		<result column="DEL_SGMT_CODE" property="delSgmtCode"/> 
		<result column="DEL_START_DATE" property="delStartDate"/>
		<result column="DEL_END_DATE" property="delEndDate"/>
		<result column="LAST_UPDATE_TIME" property="lastUpdateTime"/> 
		<result column="OPERATOR_USER" property="operatorUser"/> 
		<result column="ORG_NAME" property="orgName"/> 
		<result column="ORG_CODE" property="orgCode"/> 
		<result column="BUSINESS_STATES" property="businessStates"/> 
		<result column="REJECT_REASON" property="rejectReason"/> 
		<result column="IS_FILTER" property="isFilter"/> 
		<result column="REPORT_MESSAGE_ID" property="reportMessageId"/> 
		<result column="RPT_DATE" property="rptDate"/> 
		<result column="NAME" property="name"/> 
		<result column="ID_TYPE" property="idType"/> 
		<result column="ID_NUM" property="idNum"/>
		<result column="PK" property="pk"/>
		<result column="INF_SURC_CODE" property="infSurcCode"/>
</resultMap>
	<select id="delaccountDatalistPage" parameterType="page" resultMap="inDellistResultMap">
		SELECT *
  FROM (SELECT PAY_IN_BS_INF_DLT_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               null AS DEL_REC_CODE,
               null AS DEL_SGMT_CODE,
               null AS DEL_START_DATE,
               null AS DEL_END_DATE,
               INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_BS_INF_DLT <!--个人基本信息整笔删除请求记录    -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PAZ_IN_ID_EFCT_INF_DLT_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               null AS DEL_REC_CODE,
               null AS DEL_SGMT_CODE,
               null AS DEL_START_DATE,
               null AS DEL_END_DATE,
               INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_ID_EFCT_INF_DLT		<!-- 个人证件有效期信息整笔删除 -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PBY_IN_ACCT_DEL_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               DEL_REC_CODE,
               DEL_SGMT_CODE,
               DEL_START_DATE,
               DEL_END_DATE,
               null AS INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_ACCT_DEL	<!-- 个人借贷账户按段删除 -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PBZ_IN_ACCT_ENT_DEL_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               DEL_REC_CODE,
               null AS DEL_SGMT_CODE,
               null AS DEL_START_DATE,
               null AS DEL_END_DATE,
               null AS INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_ACCT_ENT_DEL	<!-- 个人借贷账户整笔删除 -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PCY_IN_CTRCT_DEL_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               DEL_REC_CODE,
               DEL_SGMT_CODE,
               DEL_START_DATE,
               DEL_END_DATE,
               null AS INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_CTRCT_DEL		<!-- 个人授信协议按段删除 -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PCZ_IN_CTRCT_ENT_DEL_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               DEL_REC_CODE,
               null AS DEL_SGMT_CODE,
               null AS DEL_START_DATE,
               null AS DEL_END_DATE,
               null AS INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_CTRCT_ENT_DEL		<!-- 个人授信协议整笔删除 -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PDY_IN_SEC_ACCT_DEL_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               DEL_REC_CODE,
               DEL_SGMT_CODE,
               DEL_START_DATE,
               DEL_END_DATE,
               null AS INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_SEC_ACCT_DEL		<!-- 个人担保账户按段删除 -->
          WHERE COMPANY = #{pd.COMPANY}
        UNION ALL
        SELECT PDZ_IN_SEC_ACCT_ENT_DEL_ID AS PBY_IN_ACCT_DEL_ID,
               INF_REC_TYPE,
               DEL_REC_CODE,
               null AS DEL_SGMT_CODE,
               null AS DEL_START_DATE,
               null AS DEL_END_DATE,
               null AS INF_SURC_CODE,
               LAST_UPDATE_TIME,
               OPERATOR_USER,
               ORG_NAME,
               ORG_CODE,
               BUSINESS_STATES,
               REJECT_REASON,
               IS_FILTER,
               REPORT_MESSAGE_ID,
               RPT_DATE,
               NAME,
               ID_TYPE,
               ID_NUM,
               COMPANY
          FROM I_IN_SEC_ACCT_ENT_DEL
          WHERE COMPANY = #{pd.COMPANY}
          ) a		<!-- 个人担保账户整笔删除 -->
	     <where>
	     		1=1
				<if test="pd.acctType != null and pd.acctType != ''">
				    and a.INF_REC_TYPE = #{pd.acctType}  
				</if>
				<if test='pd.acctCode != null and pd.acctCode != ""'>
					and a.DEL_REC_CODE like '%${pd.acctCode}%'
				</if>
				<if test="pd.businessStates != null and pd.businessStates != '' ">
				     and a.business_states = #{pd.businessStates}
				</if>
			    <if test='pd.queryType == "APPLY"'>
					and a.business_states in ('10','11','40','80','110','20')
				</if>
				<if test='pd.queryType == "CHECK"'>
					and a.business_states in ('20')
				</if>
				<if test='pd.rptDate != null and pd.rptDate != ""'>
					and a.RPT_DATE = #{pd.rptDate}
				</if>
			         and a.COMPANY = #{pd.COMPANY}
		
			</where>   
	</select>
	
	<!-- 删除213-个人借贷账户按段删除请求记录 -->
	<delete id="delLoan" parameterType="pd">
		delete from I_IN_ACCT_DEL where PBY_IN_ACCT_DEL_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!-- 删除134-个人证件有效期信息整笔删除请求记录 -->
	<delete id="delIDE" parameterType="pd">
		delete from I_IN_ID_EFCT_INF_DLT where PAZ_IN_ID_EFCT_INF_DLT_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!--  删除233-个人担保账户按段删除请求记录 -->
	<delete id="delGua" parameterType="pd">
		delete from I_IN_SEC_ACCT_DEL where PDY_IN_SEC_ACCT_DEL_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!-- 删除114-个人基本信息整笔删除请求记录 -->
	<delete id="delBasic" parameterType="pd">
		delete from I_IN_BS_INF_DLT where PAY_IN_BS_INF_DLT_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!-- 删除223-个人授信协议按段删除请求记录 -->
	<delete id="delPro" parameterType="pd">
		delete from I_IN_CTRCT_DEL where PCY_IN_CTRCT_DEL_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!-- 删除234-个人担保账户整笔删除请求记录 -->
	<delete id="delGuaEnt" parameterType="pd">
		delete from I_IN_SEC_ACCT_ENT_DEL where PDZ_IN_SEC_ACCT_ENT_DEL_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!--  删除214-个人借贷账户整笔删除请求记录 -->
	<delete id="delLoanEnt" parameterType="pd">
		delete from I_IN_ACCT_ENT_DEL where PBZ_IN_ACCT_ENT_DEL_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!-- 删除224-个人授信协议整笔删除请求记录 -->
	<delete id="delProEnt" parameterType="pd">
		delete from I_IN_CTRCT_ENT_DEL where PCZ_IN_CTRCT_ENT_DEL_ID=#{pk} and COMPANY = #{COMPANY}
	</delete>
	<!-- 插入213-个人借贷账户按段删除请求记录 -->
	<insert id='saveLoan' parameterType="pd">
		insert into I_IN_ACCT_DEL (
		PBY_IN_ACCT_DEL_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		DEL_REC_CODE,                                                                                                               
		DEL_SGMT_CODE,                                                                                                                
		DEL_START_DATE,                                                                                                            
		DEL_END_DATE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,                                                                                                              
		NAME,                          
		ID_TYPE,
		ID_NUM,
		COMPANY        
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                                      
		#{delRecCode},                                                                                                                                    
		#{delSgmtCode},  
		#{delStartDate},
		#{delEndDate},
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},                                                                                                                              
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{COMPANY}
		)
	</insert>
	<!-- 插入134-个人证件有效期信息整笔删除请求记录 -->
	<insert id='saveIDE' parameterType="pd">
		insert into I_IN_ID_EFCT_INF_DLT (
		PAZ_IN_ID_EFCT_INF_DLT_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		NAME,                                                                                                                    
		ID_TYPE,                                                                                                               
		ID_NUM,                                                                                                                
		INF_SURC_CODE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,
		COMPANY     
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                             
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{infSurcCode},
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},
		#{COMPANY}
		)
	</insert>
	<!-- 插入233-个人担保账户按段删除请求记录  -->
	<insert id='saveGua' parameterType="pd">
		insert into I_IN_SEC_ACCT_DEL (
		PDY_IN_SEC_ACCT_DEL_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		DEL_REC_CODE,                                                                                                               
		DEL_SGMT_CODE,                                                                                                                
		DEL_START_DATE,                                                                                                            
		DEL_END_DATE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,                                                                                                              
		NAME,                          
		ID_TYPE,
		ID_NUM,
		COMPANY        
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                                      
		#{delRecCode},                                                                                                                                    
		#{delSgmtCode},  
		#{delStartDate},
		#{delEndDate},
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},                                                                                                                              
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{COMPANY}
		)
	</insert>
	<!-- 插入114-个人基本信息整笔删除请求记录 -->
	<insert id='saveBasic' parameterType="pd">
		insert into I_IN_BS_INF_DLT (
		PAY_IN_BS_INF_DLT_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                                 
		NAME,                          
		ID_TYPE,
		ID_NUM,                                                                                                                    
		INF_SURC_CODE,                                                                                                          
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,
		COMPANY
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                               
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{infSurcCode},
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},
		#{COMPANY}
		)
	</insert>
	<!-- 插入223-个人授信协议按段删除请求记录 -->
	<insert id='savePro' parameterType="pd">
		insert into I_IN_CTRCT_DEL (
		PCY_IN_CTRCT_DEL_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		DEL_REC_CODE,                                                                                                               
		DEL_SGMT_CODE,                                                                                                                
		DEL_START_DATE,                                                                                                            
		DEL_END_DATE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,                                                                                                              
		NAME,                          
		ID_TYPE,
		ID_NUM,
		COMPANY        
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                                      
		#{delRecCode},                                                                                                                                    
		#{delSgmtCode},  
		#{delStartDate},
		#{delEndDate},
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},                                                                                                                              
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{COMPANY}
		)
	</insert>
	<!-- 插入234-个人担保账户整笔删除请求记录 -->
	<insert id='saveGuaEnt' parameterType="pd">
		insert into I_IN_SEC_ACCT_ENT_DEL (
		PDZ_IN_SEC_ACCT_ENT_DEL_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		DEL_REC_CODE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,                                                                                                              
		NAME,                          
		ID_TYPE,
		ID_NUM,
		COMPANY        
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                                      
		#{delRecCode},                                                                                                                                    
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},                                                                                                                              
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{COMPANY}
		)
	</insert>
	<!-- 插入214-个人借贷账户整笔删除请求记录 -->
	<insert id='saveLoanEnt' parameterType="pd">
		insert into I_IN_ACCT_ENT_DEL (
		PBZ_IN_ACCT_ENT_DEL_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		DEL_REC_CODE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,                                                                                                              
		NAME,                          
		ID_TYPE,
		ID_NUM,
		COMPANY        
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                                      
		#{delRecCode},                                                                                                                                    
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},                                                                                                                              
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{COMPANY}
		)
	</insert>
	<!-- 插入224-个人授信协议整笔删除请求记录 -->
	<insert id='saveProEnt' parameterType="pd">
		insert into I_IN_CTRCT_ENT_DEL (
		PCZ_IN_CTRCT_ENT_DEL_ID,                                                                                                                               
		INF_REC_TYPE ,                                                                                                           
		DEL_REC_CODE,                                                                                                               
		LAST_UPDATE_TIME,                                                                                                            
		OPERATOR_USER,                                                                                                                           
		ORG_NAME,                                                                                                           
		ORG_CODE,                                                                                                                
		BUSINESS_STATES,                                                                                                                           
		REJECT_REASON,                                                                                                                       
		IS_FILTER,                                                                                         
		REPORT_MESSAGE_ID,                                                                                                      
		RPT_DATE,                                                                                                              
		NAME,                          
		ID_TYPE,
		ID_NUM,
		COMPANY        
		) 
		values
		(
		#{pk},
		#{infRecType},                                                                                                                                      
		#{delRecCode},                                                                                                                                    
		#{lastUpdateTime},                                                                                                                              
		#{operatorUser},                                                                                                                                             
		#{orgName},                                                                                                                                  
		#{orgCode},                                                                                                                                  
		'11',                                                                                                                                        
		#{rejectReason},                                                                                                                                           
		#{isFilter},                                                                                                        
		#{reportMessageId},                                                                                                                  
		#{rptDate},                                                                                                                              
		#{name},                                  
		#{idType},                     
		#{idNum},
		#{COMPANY}
		)
	</insert>
	<!-- 更改213-个人借贷账户按段删除请求记录 -->
	<update id="updateLoan" parameterType="pd">
		 update I_IN_ACCT_DEL SET 
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="delRecCode != null and delRecCode != ''">
		 	DEL_REC_CODE = #{delRecCode} ,
		</if>
		<if test="delSgmtCode != null and delSgmtCode != ''">
			DEL_SGMT_CODE = #{delSgmtCode} ,
		</if>
		<if test="delStartDate != null">
			DEL_START_DATE = #{delStartDate} ,
		</if>
		<if test="delEndDate != null">
			DEL_END_DATE = #{delEndDate},
		</if>
		<if test="rptDate != null">
			RPT_DATE = #{rptDate}
		</if>
         where PBY_IN_ACCT_DEL_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改134-个人证件有效期信息整笔删除请求记录 -->  
	<update id="updateIDE" parameterType="pd">
		 update I_IN_ID_EFCT_INF_DLT SET 
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="name != null and name != ''">
		    NAME = #{name} ,
		</if>
		<if test="idType != null and idType != ''">
			ID_TYPE = #{idType} ,
		</if>
		<if test="idNum != null and idNum != ''">
			ID_NUM = #{idNum} ,
		</if>
		<if test="infSurcCode != null">
			INF_SURC_CODE = #{infSurcCode} ,
		</if>
		<if test="rptDate != null">
			RPT_DATE = #{rptDate}
		</if>
         where PAZ_IN_ID_EFCT_INF_DLT_ID = #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改233-个人担保账户按段删除请求记录 -->
	<update id="updateGua" parameterType="pd">
		 update I_IN_SEC_ACCT_DEL SET 
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="delRecCode != null">
		 	DEL_REC_CODE = #{delRecCode} ,
		</if>
		<if test="delSgmtCode != null and delSgmtCode != ''">
			DEL_SGMT_CODE = #{delSgmtCode} ,
		</if>
		<if test="delStartDate != null">
			DEL_START_DATE = #{delStartDate} ,
		</if>
		<if test="delEndDate != null">
			DEL_END_DATE = #{delEndDate},
		</if>
		<if test="rptDate != null">
			RPT_DATE = #{rptDate}
		</if>
         where PDY_IN_SEC_ACCT_DEL_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改114-个人基本信息整笔删除请求记录 -->
	<update id="updateBasic" parameterType="pd">
		 update I_IN_BS_INF_DLT SET
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
         <if test="name != null and name != ''">
		 	NAME = #{name} ,
		</if>
		<if test="idType != null and idType != ''">
			ID_TYPE = #{idType} ,
		</if>
		<if test="idNum != null and idNum != ''">
			ID_NUM = #{idNum} ,
		</if>
		<if test="infSurcCode != null and infSurcCode != ''">
			INF_SURC_CODE = #{infSurcCode} ,
		</if>
		<if test="rptDate != null and rptDate != ''">
			RPT_DATE = #{rptDate}
		</if>
         where PAY_IN_BS_INF_DLT_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改223-个人授信协议按段删除请求记录 -->
	<update id="updatePro" parameterType="pd">
		 update I_IN_CTRCT_DEL SET 
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="delRecCode != null">
		 	DEL_REC_CODE = #{delRecCode} ,
		</if>
		<if test="delSgmtCode != null and delSgmtCode != ''">
			DEL_SGMT_CODE = #{delSgmtCode} ,
		</if>
		<if test="delStartDate != null">
			DEL_START_DATE = #{delStartDate} ,
		</if>
		<if test="delEndDate != null">
			DEL_END_DATE = #{delEndDate},
		</if>
		<if test="rptDate != null">
			RPT_DATE = #{rptDate}
		</if>
         where PCY_IN_CTRCT_DEL_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改234-个人担保账户整笔删除请求记录 -->
	<update id="updateGuaEnt" parameterType="pd">
		 update I_IN_SEC_ACCT_ENT_DEL SET
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="delRecCode != null and delRecCode != ''">
		 	DEL_REC_CODE = #{delRecCode} ,
		</if>
		<if test="rptDate != null and rptDate != ''">
			RPT_DATE = #{rptDate}
		</if>
         where PDZ_IN_SEC_ACCT_ENT_DEL_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改214-个人借贷账户整笔删除请求记录 -->
	<update id="updateLoanEnt" parameterType="pd">
		 update I_IN_ACCT_ENT_DEL SET
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="delRecCode != null and delRecCode != ''">
		 	DEL_REC_CODE = #{delRecCode} ,
		</if>
		<if test="rptDate != null and rptDate != ''">
			RPT_DATE = #{rptDate}
		</if>
         where PBZ_IN_ACCT_ENT_DEL_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	<!-- 更改224-个人授信协议整笔删除请求记录 -->
	<update id="updateProEnt" parameterType="pd">
		 update I_IN_CTRCT_ENT_DEL SET
		 <if test="_databaseId == 'mysql'">
		 LAST_UPDATE_TIME = date_format(now(), '%Y-%m-%d'),
		 </if>
		 <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		 LAST_UPDATE_TIME = to_char(SYSDATE, 'YYYY-MM-DD'),
		 </if>
        <if test="delRecCode != null and delRecCode != ''">
		 	DEL_REC_CODE = #{delRecCode} ,
		</if>
		<if test="rptDate != null and rptDate != ''">
			RPT_DATE = #{rptDate}
		</if>
         where PCZ_IN_CTRCT_ENT_DEL_ID =  #{pk}
           and COMPANY = #{COMPANY}
	</update>
	
		<!-- 插入Excel批量导入信息 -->
	<insert id="saveIDelBatchInfo" parameterType="list" useGeneratedKeys="false">
		INSERT INTO I_DEL_ENTDEL_BATCH_INFO(
					INF_REC_TYPE,
					NAME,
					ID_TYPE,
					ID_NUM,
					INF_SURC_CODE,
					DEL_REC_CODE,
					DEL_SGMT_CODE,
					DEL_START_DATE,
					DEL_END_DATE,
					RPT_DATE,
					STATUS,
					COMPANY,
					INS_TIME
					)
		  <foreach collection="list" item="item" separator="union">
					SELECT
						#{item.INF_REC_TYPE},
						#{item.NAME},
						#{item.ID_TYPE},
						#{item.ID_NUM},
						#{item.INF_SURC_CODE},
						#{item.DEL_REC_CODE},
						#{item.DEL_SGMT_CODE},
						#{item.DEL_START_DATE},
						#{item.DEL_END_DATE},
						#{item.RPT_DATE},
						'0',
						#{item.COMPANY},
						<if test="_databaseId == 'mysql'">
						    date_format(NOW(),'%Y-%m-%d %H:%i:%s')
						</if>
						<if test="_databaseId == 'oracle' or _databaseId == 'db2'">
						    TO_CHAR(SYSDATE,'yyyy-mm-dd hh24:mi:ss')
						</if>
					FROM DUAL
		 </foreach>
	</insert>
	
	<insert id="saveBasicByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_BS_INF_DLT (
			PAY_IN_BS_INF_DLT_ID,                                                                                                                               
			INF_REC_TYPE ,                                                                                                                 
			NAME,                          
			ID_TYPE,
			ID_NUM,                                                                                                                    
			INF_SURC_CODE,                                                                                                          
			LAST_UPDATE_TIME,                                                                                                            
			OPERATOR_USER,                                                                                                                           
			BUSINESS_STATES,                                                                                                                           
			IS_FILTER,                                                                                         
			RPT_DATE,
			COMPANY
		) 
		SELECT 
				<if test="_databaseId == 'oracle' ">
				sys_guid(),
				</if>
				<if test="_databaseId == 'db2'">
				concat (hex (RAND ()), hex (RAND ())),
				</if>
				<if test="_databaseId == 'mysql'">
				upper(replace(uuid(),'-',''))
				</if>
		       A.INF_REC_TYPE,
		       A.NAME,
		       A.ID_TYPE,
		       A.ID_NUM,
		       A.INF_SURC_CODE,
		       <if test="_databaseId == 'mysql'">
		           date_format(now(), '%Y-%m-%d'),
		       </if>
		       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
		       </if>
		       #{OPERATOR_USER},
		       '20' as BUSINESS_STATES,
		       'N' as IS_FILTER,
		       A.RPT_DATE,
		       A.COMPANY
		  FROM I_DEL_ENTDEL_BATCH_INFO A
		 INNER JOIN (SELECT ID_TYPE, ID_NUM, INF_SURC_CODE
		               FROM I_BS_HIST
		              WHERE INF_REC_TYPE = '110'
		              GROUP BY ID_TYPE, ID_NUM, INF_SURC_CODE) B
		    ON A.ID_TYPE = B.ID_TYPE
		   AND A.ID_NUM = B.ID_NUM
		   AND A.INF_SURC_CODE = B.INF_SURC_CODE
		 WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		   AND A.COMPANY = #{COMPANY}
		   AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusByIEntDel" parameterType="pd">
		UPDATE I_DEL_ENTDEL_BATCH_INFO
		   SET STATUS = '1'
		 WHERE COMPANY = #{COMPANY}
		   AND STATUS = '0'
		   AND INF_REC_TYPE = #{INF_REC_TYPE}
		   AND (ID_TYPE, ID_NUM, INF_SURC_CODE) IN
		       (SELECT ID_TYPE, ID_NUM, INF_SURC_CODE
		          FROM I_IN_BS_INF_DLT
		         WHERE COMPANY = #{COMPANY}
		           AND BUSINESS_STATES = '20'
		           AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	
	<insert id="saveIDEByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_ID_EFCT_INF_DLT (
				PAZ_IN_ID_EFCT_INF_DLT_ID,                                                                                                                               
				INF_REC_TYPE ,                                                                                                           
				NAME,                                                                                                                    
				ID_TYPE,                                                                                                               
				ID_NUM,                                                                                                                
				INF_SURC_CODE,                                                                                                               
				LAST_UPDATE_TIME,                                                                                                            
				OPERATOR_USER,                                                                                                                           
				BUSINESS_STATES,                                                                                                                           
				IS_FILTER,                                                                                         
				RPT_DATE,
				COMPANY     
			) 
			SELECT <if test="_databaseId == 'oracle' ">
					sys_guid(),
					</if>
					<if test="_databaseId == 'db2'">
					concat (hex (RAND ()), hex (RAND ())),
					</if>
					<if test="_databaseId == 'mysql'">
					    upper(replace(uuid(),'-',''))
					</if>
		           A.INF_REC_TYPE,
		           A.NAME,
		           A.ID_TYPE,
		           A.ID_NUM,
		           A.INF_SURC_CODE,
		           <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
			       </if>
			       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
			           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
			       </if>
		           #{OPERATOR_USER},
		           '20' as BUSINESS_STATES,
		           'N' as IS_FILTER,
		           A.RPT_DATE,
		           A.COMPANY
		      FROM I_DEL_ENTDEL_BATCH_INFO A
     		 INNER JOIN (SELECT ID_TYPE, ID_NUM, INF_SURC_CODE
			               FROM I_IN_ID_EFCT_INF_HIST
			              WHERE INF_REC_TYPE = '130'
			              GROUP BY ID_TYPE, ID_NUM, INF_SURC_CODE) B
		        ON A.ID_TYPE = B.ID_TYPE
		       AND A.ID_NUM = B.ID_NUM
		       AND A.INF_SURC_CODE = B.INF_SURC_CODE
		     WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		       AND A.COMPANY = #{COMPANY}
		       AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusByIDEEntDel" parameterType="pd">
		UPDATE I_DEL_ENTDEL_BATCH_INFO
		   SET STATUS = '1'
		 WHERE COMPANY = #{COMPANY}
		   AND STATUS = '0'
		   AND INF_REC_TYPE = #{INF_REC_TYPE}
		   AND (ID_TYPE, ID_NUM, INF_SURC_CODE) IN
		       (SELECT ID_TYPE, ID_NUM, INF_SURC_CODE
		          FROM I_IN_ID_EFCT_INF_DLT
		         WHERE COMPANY = #{COMPANY}
		           AND BUSINESS_STATES = '20'
		           AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	
	<insert id="saveLoanSgmtByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_ACCT_DEL (
				PBY_IN_ACCT_DEL_ID,                                                                                                                               
				INF_REC_TYPE ,                                                                                                           
				DEL_REC_CODE,                                                                                                               
				DEL_SGMT_CODE,                                                                                                                
				DEL_START_DATE,                                                                                                            
				DEL_END_DATE,                                                                                                               
				LAST_UPDATE_TIME,                                                                                                            
				OPERATOR_USER,                                                                                                                           
				BUSINESS_STATES,                                                                                                                           
				IS_FILTER,                                                                                         
				RPT_DATE,                                                                                                              
				COMPANY        
				) 
			SELECT 
				<if test="_databaseId == 'oracle' ">
				sys_guid(),
				</if>
				<if test="_databaseId == 'db2'">
				concat (hex (RAND ()), hex (RAND ())),
				</if>
				<if test="_databaseId == 'mysql'">
				    upper(replace(uuid(),'-',''))
				</if>
		           A.INF_REC_TYPE,
		           A.DEL_REC_CODE,
		           A.DEL_SGMT_CODE,
		           A.DEL_START_DATE,
		           A.DEL_END_DATE,
		           <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
			       </if>
			       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
			           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
			       </if>
		           #{OPERATOR_USER},
		           '20' as BUSINESS_STATES,
		           'N' as IS_FILTER,
		           A.RPT_DATE,
		           A.COMPANY
		      FROM I_DEL_ENTDEL_BATCH_INFO A
		     INNER JOIN (SELECT ACCT_TYPE, ACCT_CODE
			               FROM I_ACCT_BS_HIST
			              WHERE INF_REC_TYPE = '210'
			              GROUP BY ACCT_TYPE, ACCT_CODE) B
		        ON A.DEL_REC_CODE = B.ACCT_CODE
		     WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		       AND A.COMPANY = #{COMPANY}
		       AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusByLoanSgmt" parameterType="pd">
		    UPDATE I_DEL_ENTDEL_BATCH_INFO
		       SET STATUS = '1'
		     WHERE COMPANY = #{COMPANY}
		       AND STATUS = '0'
		       AND INF_REC_TYPE = #{INF_REC_TYPE}
		       AND (DEL_REC_CODE, DEL_SGMT_CODE) IN
		           (SELECT DEL_REC_CODE, DEL_SGMT_CODE
		              FROM I_IN_ACCT_DEL
		             WHERE COMPANY = #{COMPANY}
		               AND BUSINESS_STATES = '20'
		               AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	
	<insert id="saveCtrctSgmtByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_CTRCT_DEL (
					PCY_IN_CTRCT_DEL_ID,                                                                                                                               
					INF_REC_TYPE ,                                                                                                           
					DEL_REC_CODE,                                                                                                               
					DEL_SGMT_CODE,                                                                                                                
					DEL_START_DATE,                                                                                                            
					DEL_END_DATE,                                                                                                               
					LAST_UPDATE_TIME,                                                                                                            
					OPERATOR_USER,                                                                                                                           
					BUSINESS_STATES,                                                                                                                           
					IS_FILTER,                                                                                         
					RPT_DATE,                                                                                                              
					COMPANY        
					)  
			SELECT <if test="_databaseId == 'oracle' ">
					sys_guid(),
					</if>
					<if test="_databaseId == 'db2'">
					concat (hex (RAND ()), hex (RAND ())),
					</if>
					<if test="_databaseId == 'mysql'">
					    upper(replace(uuid(),'-',''))
					</if>
		           A.INF_REC_TYPE,
		           A.DEL_REC_CODE,
		           A.DEL_SGMT_CODE,
		           A.DEL_START_DATE,
		           A.DEL_END_DATE,
		          <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
			       </if>
			       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
			           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
			       </if>
		           #{OPERATOR_USER},
		           '20' as BUSINESS_STATES,
		           'N' as IS_FILTER,
		           A.RPT_DATE,
		           A.COMPANY
		      FROM I_DEL_ENTDEL_BATCH_INFO A
		     INNER JOIN (SELECT CONTRACT_CODE
			               FROM I_CTRCT_BS_HIST
			              WHERE INF_REC_TYPE = '220'
			              GROUP BY CONTRACT_CODE) B
		        ON A.DEL_REC_CODE = B.CONTRACT_CODE
		     WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		       AND A.COMPANY = #{COMPANY}
		       AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusByCtrctSgmt" parameterType="pd">
		    UPDATE I_DEL_ENTDEL_BATCH_INFO
		       SET STATUS = '1'
		     WHERE COMPANY = #{COMPANY}
		       AND STATUS = '0'
		       AND INF_REC_TYPE = #{INF_REC_TYPE}
		       AND (DEL_REC_CODE, DEL_SGMT_CODE) IN
		           (SELECT DEL_REC_CODE, DEL_SGMT_CODE
		              FROM I_IN_CTRCT_DEL
		             WHERE COMPANY = #{COMPANY}
		               AND BUSINESS_STATES = '20'
		               AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	<insert id="saveSecSgmtByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_SEC_ACCT_DEL (
				PDY_IN_SEC_ACCT_DEL_ID,                                                                                                                               
				INF_REC_TYPE ,                                                                                                           
				DEL_REC_CODE,                                                                                                               
				DEL_SGMT_CODE,                                                                                                                
				DEL_START_DATE,                                                                                                            
				DEL_END_DATE,                                                                                                               
				LAST_UPDATE_TIME,                                                                                                            
				OPERATOR_USER,                                                                                                                           
				BUSINESS_STATES,                                                                                                                           
				IS_FILTER,                                                                                         
				RPT_DATE,                                                                                                              
				COMPANY        
				)   
			SELECT <if test="_databaseId == 'oracle' ">
					sys_guid(),
					</if>
					<if test="_databaseId == 'db2'">
					concat (hex (RAND ()), hex (RAND ())),
					</if>
					<if test="_databaseId == 'mysql'">
					    upper(replace(uuid(),'-',''))
					</if>
		           A.INF_REC_TYPE,
		           A.DEL_REC_CODE,
		           A.DEL_SGMT_CODE,
		           A.DEL_START_DATE,
		           A.DEL_END_DATE,
		           <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
			       </if>
			       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
			           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
			       </if>
		           #{OPERATOR_USER},
		           '20' as BUSINESS_STATES,
		           'N' as IS_FILTER,
		           A.RPT_DATE,
		           A.COMPANY
		      FROM I_DEL_ENTDEL_BATCH_INFO A
		     INNER JOIN (SELECT ACCT_TYPE, ACCT_CODE
			               FROM I_GUAR_ACCT_BS_HIST
			              WHERE INF_REC_TYPE = '230'
			              GROUP BY ACCT_TYPE, ACCT_CODE) B
		        ON A.DEL_REC_CODE = B.ACCT_CODE
		     WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		       AND A.COMPANY = #{COMPANY}
		       AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusBySecSgmt" parameterType="pd">
		    UPDATE I_DEL_ENTDEL_BATCH_INFO
		       SET STATUS = '1'
		     WHERE COMPANY = #{COMPANY}
		       AND STATUS = '0'
		       AND INF_REC_TYPE = #{INF_REC_TYPE}
		       AND (DEL_REC_CODE, DEL_SGMT_CODE) IN
		           (SELECT DEL_REC_CODE, DEL_SGMT_CODE
		              FROM I_IN_SEC_ACCT_DEL
		             WHERE COMPANY = #{COMPANY}
		               AND BUSINESS_STATES = '20'
		               AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	
	<insert id="saveLoanEntByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_ACCT_ENT_DEL (
				PBZ_IN_ACCT_ENT_DEL_ID,                                                                                                                               
				INF_REC_TYPE ,                                                                                                           
				DEL_REC_CODE,                                                                                                               
				LAST_UPDATE_TIME,                                                                                                            
				OPERATOR_USER,                                                                                                                           
				BUSINESS_STATES,                                                                                                                           
				IS_FILTER,                                                                                         
				RPT_DATE,                                                                                                              
				COMPANY        
				) 
		SELECT <if test="_databaseId == 'oracle' ">
				sys_guid(),
				</if>
				<if test="_databaseId == 'db2'">
				concat (hex (RAND ()), hex (RAND ())),
				</if>
				<if test="_databaseId == 'mysql'">
				    upper(replace(uuid(),'-',''))
				</if>
               A.INF_REC_TYPE,
               A.DEL_REC_CODE,
               <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
		       </if>
		       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
		           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
		       </if>
               #{OPERATOR_USER},
               '20' as BUSINESS_STATES,
               'N' as IS_FILTER,
               A.RPT_DATE,
               A.COMPANY
          FROM I_DEL_ENTDEL_BATCH_INFO A
         INNER JOIN (SELECT ACCT_TYPE, ACCT_CODE
                     FROM I_ACCT_BS_HIST
                    WHERE INF_REC_TYPE = '210'
                    GROUP BY ACCT_TYPE, ACCT_CODE) B
            ON A.DEL_REC_CODE = B.ACCT_CODE
         WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
           AND A.COMPANY = #{COMPANY}
           AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusByLoanEnt" parameterType="pd">
		    UPDATE I_DEL_ENTDEL_BATCH_INFO
		       SET STATUS = '1'
		     WHERE COMPANY = #{COMPANY}
		       AND STATUS = '0'
		       AND INF_REC_TYPE = #{INF_REC_TYPE}
		       AND DEL_REC_CODE IN
		           (SELECT DEL_REC_CODE
		              FROM I_IN_ACCT_ENT_DEL
		             WHERE COMPANY = #{COMPANY}
		               AND BUSINESS_STATES = '20'
		               AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	
	<insert id="saveCtrctEntByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_CTRCT_ENT_DEL (
				PCZ_IN_CTRCT_ENT_DEL_ID,                                                                                                                               
				INF_REC_TYPE ,                                                                                                           
				DEL_REC_CODE,                                                                                                               
				LAST_UPDATE_TIME,                                                                                                            
				OPERATOR_USER,                                                                                                                           
				BUSINESS_STATES,                                                                                                                           
				IS_FILTER,                                                                                         
				RPT_DATE,                                                                                                              
				COMPANY        
				) 
			SELECT <if test="_databaseId == 'oracle' ">
					sys_guid(),
					</if>
					<if test="_databaseId == 'db2'">
					concat (hex (RAND ()), hex (RAND ())),
					</if>
					<if test="_databaseId == 'mysql'">
					    upper(replace(uuid(),'-',''))
					</if>
		           A.INF_REC_TYPE,
		           A.DEL_REC_CODE,
		           <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
			       </if>
			       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
			           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
			       </if>
		           #{OPERATOR_USER},
		           '20' as BUSINESS_STATES,
		           'N' as IS_FILTER,
		           A.RPT_DATE,
		           A.COMPANY
		      FROM I_DEL_ENTDEL_BATCH_INFO A
		     INNER JOIN (SELECT CONTRACT_CODE
			               FROM I_CTRCT_BS_HIST
			              WHERE INF_REC_TYPE = '220'
			              GROUP BY CONTRACT_CODE) B
		        ON A.DEL_REC_CODE = B.CONTRACT_CODE
		     WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		       AND A.COMPANY = #{COMPANY}
		       AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusByCtrctEnt" parameterType="pd">
		    UPDATE I_DEL_ENTDEL_BATCH_INFO
		       SET STATUS = '1'
		     WHERE COMPANY = #{COMPANY}
		       AND STATUS = '0'
		       AND INF_REC_TYPE = #{INF_REC_TYPE}
		       AND DEL_REC_CODE IN
		           (SELECT DEL_REC_CODE
		              FROM I_IN_CTRCT_ENT_DEL
		             WHERE COMPANY = #{COMPANY}
		               AND BUSINESS_STATES = '20'
		               AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>
	
	
	<insert id="saveSecEntByBatchList" parameterType="pd" useGeneratedKeys="false">
		insert into I_IN_SEC_ACCT_ENT_DEL (
				PDZ_IN_SEC_ACCT_ENT_DEL_ID,                                                                                                                               
				INF_REC_TYPE ,                                                                                                           
				DEL_REC_CODE,                                                                                                               
				LAST_UPDATE_TIME,                                                                                                            
				OPERATOR_USER,                                                                                                                           
				BUSINESS_STATES,                                                                                                                           
				IS_FILTER,                                                                                         
				RPT_DATE,                                                                                                              
				COMPANY        
				) 
			SELECT <if test="_databaseId == 'oracle' ">
					sys_guid(),
					</if>
					<if test="_databaseId == 'db2'">
					concat (hex (RAND ()), hex (RAND ())),
					</if>
					<if test="_databaseId == 'mysql'">
					    upper(replace(uuid(),'-',''))
					</if>
		           A.INF_REC_TYPE,
		           A.DEL_REC_CODE,
		           <if test="_databaseId == 'mysql'">
		               date_format(now(), '%Y-%m-%d'),
			       </if>
			       <if test="_databaseId == 'oracle' or _databaseId == 'db2'">
			           TO_CHAR(SYSDATE, 'yyyy-mm-dd'),
			       </if>
		           #{OPERATOR_USER},
		           '20' as BUSINESS_STATES,
		           'N' as IS_FILTER,
		           A.RPT_DATE,
		           A.COMPANY
		      FROM I_DEL_ENTDEL_BATCH_INFO A
		     INNER JOIN (SELECT ACCT_TYPE, ACCT_CODE
			               FROM I_GUAR_ACCT_BS_HIST
			              WHERE INF_REC_TYPE = '230'
			              GROUP BY ACCT_TYPE, ACCT_CODE) B
		        ON A.DEL_REC_CODE = B.ACCT_CODE
		     WHERE A.INF_REC_TYPE = #{INF_REC_TYPE}
		       AND A.COMPANY = #{COMPANY}
		       AND A.STATUS = '0'
	</insert>
	
	<update id="updateBatchStatusBySecEnt" parameterType="pd">
		   UPDATE I_DEL_ENTDEL_BATCH_INFO
		       SET STATUS = '1'
		     WHERE COMPANY = #{COMPANY}
		       AND STATUS = '0'
		       AND INF_REC_TYPE = #{INF_REC_TYPE}
		       AND DEL_REC_CODE IN
		           (SELECT DEL_REC_CODE
		              FROM I_IN_SEC_ACCT_ENT_DEL
		             WHERE COMPANY = #{COMPANY}
		               AND BUSINESS_STATES = '20'
		               AND INF_REC_TYPE = #{INF_REC_TYPE})
	</update>

</mapper>
